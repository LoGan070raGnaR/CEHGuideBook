# Vulnerability Analysis

- Vulnerability assessment is a crucial phase in ethical hacking, involving a comprehensive examination of a system's security posture. This includes current security procedures, controls, and the system's ability to withstand potential assaults. Vulnerability research is the process of identifying design flaws and vulnerabilities that could be exploited.

- After gathering information about the target system in the footprinting and scanning phases, the next step is to perform vulnerability research and assessment. Ethical hackers need to leverage acquired information to discover vulnerabilities, scan for weaknesses, and evaluate the target system's security mechanisms.

## Objective

- The objective is to extract detailed information about the target system, including network vulnerabilities, open ports, application/service configurations, OS version, installed applications, weak passwords, insecure files/folders permissions, default services, and known vulnerabilities.

## Overview of Vulnerability Assessment

- Vulnerabilities are weaknesses in the system that can be exploited to compromise security. They often result from misconfigurations or poor programming practices. Vulnerability assessment is crucial for securing organizational resources, involving patch management, antivirus installation, configuration checks, issue resolution, and hardware troubleshooting.

## Tools

#### 1. Vulnerability Research with Vulnerability Scoring Systems and Databases:
   - Common Weakness Enumeration (CWE)
   - Common Vulnerabilities and Exposures (CVE)
   - National Vulnerability Database (NVD)

#### 2. Vulnerability Assessment using Various Tools:
   - OpenVAS
   - Nessus
   - GFI LanGuard
   - CGI Scanner Nikto for Web Servers and Applications

---

### 1. Vulnerability Research with Vulnerability Scoring Systems and Databases

- Vulnerability scoring systems and databases play a crucial role in the arsenal of security analysts. These tools are employed to rank vulnerabilities within information systems, offering a composite score that reflects the overall severity and risk associated with identified security flaws.

- As a professional ethical hacker or pen tester, the initial task is to search for vulnerabilities in the target system or network using vulnerability scoring systems and databases. This research provides insights into advanced techniques for identifying flaws or loopholes in software, laying the foundation for employing various tricks and techniques to launch attacks on the target system.

**Overview of Vulnerabilities in Vulnerability Scoring Systems and Databases**

- Vulnerability databases serve as repositories for information about various vulnerabilities present in information systems. Key vulnerability scoring systems and databases include:
    - Common Weakness Enumeration (CWE)
    - Common Vulnerabilities and Exposures (CVE)
    - National Vulnerability Database (NVD)
    - Common Vulnerability Scoring System (CVSS)

---

#### Vulnerability Research in Common Weakness Enumeration (CWE)

- `Common Weakness Enumeration (CWE)` is a comprehensive category system for software vulnerabilities and weaknesses, serving as a baseline for identification, mitigation, and prevention efforts.

##### Steps

- Launch a web browser and navigate to [CWE](https://cwe.mitre.org/).
- Click on the "Search" tab and enter a keyword (e.g., SMB) to find vulnerabilities.
- Explore the search results and click on a specific vulnerability (e.g., CWE-284) for detailed information.
- Analyze the vulnerability description and scroll down for additional details.
- Repeat the process for other vulnerabilities.
- Navigate back to the CWE website and click on "CWE List."
- Under "External Mappings," click on "CWE Top 25 (2021)."
- Explore the list of weaknesses in the 2021 CWE Top 25, clicking on each for detailed information.

---

#### Vulnerability Research in Common Vulnerabilities and Exposures (CVE)

- Common Vulnerabilities and Exposures (CVE) is a widely-used list of standardized identifiers for software vulnerabilities and exposures.

##### Steps

- Launch a web browser and navigate to [CVE](https://cve.mitre.org/).
- Explore the Newest CVE Entries section to find recently discovered vulnerabilities.
- Copy the name of any vulnerability and search for detailed information.
- Click on the "Search CVE List" tab, enter a vulnerability name (e.g., CVE-2021-4034), and submit.
- Review the search results, click on a specific vulnerability, and analyze the detailed information.
- Repeat the process for another vulnerability (e.g., CVE-2021-44228) and explore its details.
- Continue searching for vulnerabilities (e.g., SMB) using the Search CVE List section.
- Click on specific vulnerabilities in the search results to view detailed information.
- Explore references, descriptions, and other relevant information on each vulnerability.

---

#### Vulnerability Research in National Vulnerability Database (NVD)

- The National Vulnerability Database (NVD) is a repository of standardized vulnerability management data used by the U.S. government.

##### Steps

- Launch a web browser and navigate to [NVD](https://nvd.nist.gov/).
- Explore the NVD website to view recently discovered vulnerabilities.
- Click on a specific CVE-ID link (e.g., CVE-2022-0729) to access detailed information about the vulnerability.
- Analyze the severity, references, and weakness enumeration related to the vulnerability.
- Click on the Base Score link under the Severity section to delve into CVSS details.
- Understand the Base Score, Temporal Score, and Environmental Score related to the vulnerability.
- Scroll down to view detailed information on different score metrics such as Exploitability Metrics, Impact Metrics, etc.
- Return to the main NVD page, expand Vulnerabilities, and select the Search & Statistics option.
- Perform a keyword search for a target service (e.g., SMB) to find vulnerabilities associated with it.
- Examine the search results displaying detailed information on underlying vulnerabilities.
- Click on the Vuln ID link to view detailed information on each vulnerability.
- Repeat the process for other target services to explore vulnerabilities.

---
### 2. Vulnerability Assessment using Various Vulnerability Assessment Tools

- Vulnerability assessment tools play a crucial role in securing organizational systems and networks. Security analysts employ these tools to identify weaknesses in the security posture and address vulnerabilities before potential exploitation. Network vulnerability scanners, such as OpenVAS, Nessus, GFI LanGuard, and CGI Scanner Nikto, facilitate the identification and mitigation of vulnerabilities in target networks and resources.

---
#### Vulnerability Analysis using OpenVAS

- OpenVAS, a robust framework for vulnerability scanning and management, offers an array of services and tools.

## Steps

- Launch OpenVAS:
   - Navigate to Applications > Pentesting > Vulnerability Analysis > OpenVAS.

- Access OpenVAS Web UI:
   - Open Firefox and visit https://127.0.0.1:9392.
   - Log in with admin credentials.

- Initiate Vulnerability Scan:
   - Go to Scans > Tasks > Task Wizard.
   - Enter the target IP and start the scan.

- Review Scan Results:
   - Wait for the scan to complete (approximately 20 minutes).
   - Check the Results tab for discovered vulnerabilities.

- Explore Vulnerabilities:
   - Click on each vulnerability for detailed information.
   - Understand severity, location, and potential impact.

- Verify with Firewall On:
   - Re-run the scan after enabling the Windows Firewall on the target.
   - Observe any changes in vulnerabilities.

---

#### Vulnerability Scanning with Nessus

- Nessus is a robust assessment solution used for identifying vulnerabilities, configuration issues, and malware. It supports various technologies like OSes, network devices, web servers, and more.


## Steps

- Launch Microsoft Edge, visit `https://localhost:8834/`.
- Accept security warnings and log in to Nessus (Admin/Password).
- Initialize Nessus.
- Navigate to - Policies > Create a new policy.
- Select - Advanced Scan template.
- Configure policy settings (disabling ping, adjusting scanning options).
- Set credentials for Windows.
- Save the policy.

- **Scan Configuration**

    - Go to - Scans > Create a new scan.
    - Choose - NetworkScan_Policy under User Defined.
    - Configure scan settings (name, description, target IP).
    - Disable schedule; launch the scan.

- **Post-Scan Analysis**

    - After scan completion, view results in the - Local Network scan.
    - Explore vulnerabilities and details.

- **Generate Report**

    - Go to the scan, click - Report, choose format (e.g., HTML), generate, and download the report.

- **Detailed Analysis**

    - Open the report, view discovered vulnerabilities.
    - Click on specific vulnerabilities for detailed information.
    - Perform a thorough analysis of the Nessus scan results.

---
#### Web Servers and Applications Vulnerability Scanning using CGI Scanner Nikto

- Nikto is an Open Source (GPL) web server scanner that performs comprehensive tests against web servers for multiple items, including over 6700 potentially dangerous files/programs, checks for outdated versions of over 1250 servers, and version-specific problems on over 270 servers. It also checks for server configuration items such as the presence of multiple index files and HTTP server options; it will also attempt to identify installed web servers and software.

##### Steps

- Initialize Nikto.

```bash
sudo nikto
```

- Review the displayed Nikto scanning options to understand available commands.

```bash
nikto -H
```

- Perform a comprehensive scan with tuning options enabled. This can be achieved by specifying the target website and tuning options.

```bash
nikto -h github.com -Tuning x
```

- Save the scan results in a text file on the Desktop.

```bash
cd Desktop
nikto -h github.com -o Nikto_Scan_Results -F txt
```

- Open the saved file for review.

---